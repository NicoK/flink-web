<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink: Building a Fraud Detection System with Runtime Rules Updates on Apache Flink</title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/flink.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Blog RSS feed -->
    <link href="/blog/feed.xml" rel="alternate" type="application/rss+xml" title="Apache Flink Blog: RSS feed" />

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- We need to load Jquery in the header for custom google analytics event tracking-->
    <script src="/js/jquery.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>  
    

    <!-- Main content. -->
    <div class="container">
    <div class="row">

      
     <div id="sidebar" class="col-sm-3">
        

<!-- Top navbar. -->
    <nav class="navbar navbar-default">
        <!-- The logo. -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-logo">
            <a href="/">
              <img alt="Apache Flink" src="/img/flink-header-logo.svg" width="147px" height="73px">
            </a>
          </div>
        </div><!-- /.navbar-header -->

        <!-- The navigation links. -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-main">

            <!-- First menu section explains visitors what Flink is -->

            <!-- What is Stream Processing? -->
            <!--
            <li><a href="/streamprocessing1.html">What is Stream Processing?</a></li>
            -->

            <!-- What is Flink? -->
            <li><a href="/flink-architecture.html">What is Apache Flink?</a></li>

            

            <!-- Use cases -->
            <li><a href="/usecases.html">Use Cases</a></li>

            <!-- Powered by -->
            <li><a href="/poweredby.html">Powered By</a></li>

            <!-- FAQ -->
            <li><a href="/faq.html">FAQ</a></li>

            &nbsp;
            <!-- Second menu section aims to support Flink users -->

            <!-- Downloads -->
            <li><a href="/downloads.html">Downloads</a></li>

            <!-- Quickstart -->
            <li>
              <a href="https://ci.apache.org/projects/flink/flink-docs-release-1.9/getting-started/tutorials/local_setup.html" target="_blank">Tutorials <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>

            <!-- Documentation -->
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Documentation<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.9" target="_blank">1.9 (Latest stable release) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
                <li><a href="https://ci.apache.org/projects/flink/flink-docs-master" target="_blank">Master (Latest Snapshot) <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>
              </ul>
            </li>

            <!-- getting help -->
            <li><a href="/gettinghelp.html">Getting Help</a></li>

            <!-- Blog -->
            <li class="active"><a href="/blog/"><b>Flink Blog</b></a></li>

            <!-- Ecosystem -->
            <li><a href="/ecosystem.html">Ecosystem</a></li>

            &nbsp;

            <!-- Third menu section aim to support community and contributors -->

            <!-- Community -->
            <li><a href="/community.html">Community &amp; Project Info</a></li>

            <!-- Roadmap -->
            <li><a href="/roadmap.html">Roadmap</a></li>

            <!-- Contribute -->
            <li><a href="/contributing/how-to-contribute.html">How to Contribute</a></li>
            

            <!-- GitHub -->
            <li>
              <a href="https://github.com/apache/flink" target="_blank">Flink on GitHub <small><span class="glyphicon glyphicon-new-window"></span></small></a>
            </li>

            &nbsp;

            <!-- Language Switcher -->
            <li>
              
                
                  <!-- link to the Chinese home page when current is blog page -->
                  <a href="/zh">中文版</a>
                
              
            </li>

          </ul>

          <ul class="nav navbar-nav navbar-bottom">
          <hr />

            <!-- Twitter -->
            <li><a href="https://twitter.com/apacheflink" target="_blank">@ApacheFlink <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <!-- Visualizer -->
            <li class=" hidden-md hidden-sm"><a href="/visualizer/" target="_blank">Plan Visualizer <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

          <hr />

            <li><a href="https://apache.org" target="_blank">Apache Software Foundation <small><span class="glyphicon glyphicon-new-window"></span></small></a></li>

            <li>
              <style>
                .smalllinks:link {
                  display: inline-block !important; background: none; padding-top: 0px; padding-bottom: 0px; padding-right: 0px; min-width: 75px;
                }
              </style>

              <a class="smalllinks" href="https://www.apache.org/licenses/" target="_blank">License</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/security/" target="_blank">Security</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/sponsorship.html" target="_blank">Donate</a> <small><span class="glyphicon glyphicon-new-window"></span></small>

              <a class="smalllinks" href="https://www.apache.org/foundation/thanks.html" target="_blank">Thanks</a> <small><span class="glyphicon glyphicon-new-window"></span></small>
            </li>

          </ul>
        </div><!-- /.navbar-collapse -->
    </nav>

      </div>
      <div class="col-sm-9">
      <div class="row-fluid">
  <div class="col-sm-12">
    <div class="row">
      <h1>Building a Fraud Detection System with Runtime Rules Updates on Apache Flink</h1>

      <article>
        <p>19 Nov 2019 Alexander Fedulov (<a href="https://twitter.com/afedulov">@afedulov</a>)</p>

<p>In this series of blog posts you will learn about three powerful Flink patterns for building streaming applications:</p>

<ul>
  <li>Dynamic updates of application logic</li>
  <li>Dynamic data partitioning (shuffle), controlled at runtime</li>
  <li>Low latency alerting based on custom window logic (not using the Window API)</li>
</ul>

<p>These patterns expand the possibilities of what is possible with statically defined data flows and therefore provide important building blocks to fulfil versatile business requirements.</p>

<p><strong>Dynamic updates of application logic</strong> allow Flink jobs to change at runtime, without downtime from stopping and resubmitting the code.<br />
<br />
<strong>Dynamic data partitioning</strong> enables the ability to change how events are being distributed and grouped by the <code>keyBy()</code> operator in Flink at runtime. Such functionality often becomes a natural requirement when building jobs with dynamically reconfigurable application logic.<br />
<br />
<strong>Custom window management</strong> demonstrates how you can utilize the low level <a href="https://ci.apache.org/projects/flink/flink-docs-stable/dev/stream/operators/process_function.html">ProcessFunction API</a>, when <a href="https://ci.apache.org/projects/flink/flink-docs-stable/dev/stream/operators/windows.html">Window API</a> is not exactly matching your requirements. Specifically, you will learn how to implement low latency alerting on windows and how to limit state growth with timers.</p>

<p>The patterns are built up on top of core Flink functionality, however they might not be immediately obvious from the framework’s documentation as it is not trivial to explain and give motivation behind them without a concrete example use case. For this reason we will look at the details of the patterns on an example of building an application which represents a common use case for Apache Flink - a <em>Fraud Detection</em> engine.
We hope this series will put these powerful approaches into your tool belt and enable you to tackle new interesting use cases with Apache Flink.</p>

<p>In the first blog post of the series we will look at the high level architecture of the demo application, describe its components and their interactions. We will proceed with a deep dive into the implementation details of the first pattern in the series - <strong>dynamic data partitioning</strong>.</p>

<p>You will be able to run the full Fraud Detection Demo application locally and look into the details of the implementation by using the accompanying GitHub repository.</p>

<h3 id="fraud-detection-demo">Fraud Detection Demo</h3>

<p>If you are keen on seeing the demo application in action, feel free to checkout the following repository and follow the steps in the README to run it locally:</p>

<p><a href="https://github.com/afedulov/fraud-detection-demo">https://github.com/afedulov/fraud-detection-demo</a></p>

<p>Our Fraud Detection Demo comes in a form of a self-contained application - it only requires <code>docker</code> and <code>docker-compose</code> to be built from sources and includes the following components:</p>

<ul>
  <li>Apache Kafka (message broker) with ZooKeeper</li>
  <li>Apache Flink (<a href="https://ci.apache.org/projects/flink/flink-docs-stable/concepts/glossary.html#flink-application-cluster">application cluster</a>)</li>
  <li>Fraud Detection Web App</li>
</ul>

<p>The high level goal of the Fraud Detection engine is to consume a stream of financial transactions and evaluate a set of rules against it. Such rules are typically subject to frequent changes and tweaks. In a real production system it is therefore very important to be able to add and removed them at runtime, without incurring an expensive penalty of stopping and restarting the job.</p>

<p>When you navigate to the demo URL in your browser, you will be presented with the following UI:</p>

<center>
 <img src="/img/blog/2019-11-19-demo-fraud-detection/ui.png" width="800px" alt="Figure 1: Demo UI" />
 <br />
 <i><small>Figure 1: Fraud Detection Demo UI</small></i>
 </center>
<p><br /></p>

<p>On the left side you can see a visual representation of financial transactions flowing through the system after you click the “Start” button. The slider at the top allows you to control the number of transactions per second generated for the demo purposes. The middle section is devoted to managing the rules evaluated by Flink. In this section you can create new rules as well as issue certain control commands, such as clearing Flink’s state.</p>

<p>The demo out already of the box comes with a set of predefined sample rules. You can simply click the <em>Start</em> button and after some time observe alerts displayed in the right section of the UI. These alerts are the result of Flink evaluating the generated transactions stream against the predefined rules.</p>

<p>Our sample fraud detection application consists of three main components:</p>

<ol>
  <li>Frontend (React)</li>
  <li>Backend (SpringBoot)</li>
  <li>Fraud Detection application (Apache Flink)</li>
</ol>

<p>Interactions between the main elements is depicted on <em>Figure 2</em>.</p>

<center>
 <img src="/img/blog/2019-11-19-demo-fraud-detection/architecture.png" width="800px" alt="Figure 2: Demo Components" />
 <br />
 <i><small>Figure 2: Fraud Detection Demo Components</small></i>
 </center>
<p><br /></p>

<p>Backend exposes a REST API to the Frontend for creating and deleting rules as well as issuing control commands for managing the demo execution. It then relays those Frontend actions to Flink by sending them via a “Control” Kafka topic. Backend also includes a Transactions Generator component, which sends emulated flow of funds to Flink via a separate “Transactions” topic. Alerts generated by Flink are consumed by the Backend from “Alerts” topic and relayed to the UI via WebSockets.</p>

<p>Now that you are familiar with the overall layout and the goal of our Fraud Detection engine, let’s go into the details of what is required to implement such system.</p>

<h3 id="dynamic-data-partitioning">Dynamic Data Partitioning</h3>

<p>The first pattern we will look into is Dynamic Data Partitioning.</p>

<p>Flink’s DataStream API includes an important operator that determines the distribution of incoming data (shuffle) among the parallel computational nodes of the cluster - the <code>keyBy()</code> operator. It partitions the stream in a way that all records with the same key are assigned to the same partition and are hence sent to the same instance of the subsequent “keyed” operator. In a typical statically-defined streaming application the choice of the key is fixed and it is usually immediately derived from one of the fields of the incoming records. For instance, in case of a simple window-based computation over a stream of Tuples, we could use the first field (denoted by 0) as the key:</p>

<div class="highlight"><pre><code class="language-java"><span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">input</span> <span class="o">=</span> <span class="c1">// [...]</span>
<span class="n">DataStream</span><span class="o">&lt;...&gt;</span> <span class="n">windowed</span> <span class="o">=</span> <span class="n">input</span>
  <span class="o">.</span><span class="na">keyBy</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span>
  <span class="o">.</span><span class="na">window</span><span class="o">(</span><span class="cm">/*window specification*/</span><span class="o">);</span></code></pre></div>

<p>This is the basic building block for achieving horizontal scalability which covers a wide range of use cases. However, in a case of an application that strives to provide flexibility in business logic at runtime, this is not enough.
To understand why this is the case, let us start with articulating a realistic sample rule definition for our fraud detection system in a form of a functional requirement:</p>

<p>“Whenever the <strong>sum</strong> of accumulated <strong>payment amount</strong> from the same <strong>beneficiary</strong> to the same <strong>payee</strong> within the <strong>duration of a week</strong> is <strong>greater</strong> than <strong>1 000 000 $</strong> - fire an alert.”</p>

<p>This rule shows a number of parameters that we would like to be flexible and expose for any (new) rule that is being sent to our fraud detection application during its runtime:</p>

<p>From this formulation we can extract the following parameters that we would like to be able to specify in a system which allows flexibility in rules definition:</p>

<ol>
  <li>Aggregation field (payment amount)</li>
  <li>Grouping fields (beneficiary + payee)</li>
  <li>Aggregation function (sum)</li>
  <li>Window duration (1 week)</li>
  <li>Limit (1 000 000)</li>
  <li>Limit operator (greater)</li>
</ol>

<p>Accordingly, we will use the following simple JSON format to define the aforementioned parameters.</p>

<p>Examples JSON:</p>

<div class="highlight"><pre><code class="language-json"><span class="p">{</span>
  <span class="nt">&quot;ruleId&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;ruleState&quot;</span><span class="p">:</span> <span class="s2">&quot;ACTIVE&quot;</span><span class="p">,</span>
  <span class="nt">&quot;groupingKeyNames&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;beneficiaryId&quot;</span><span class="p">,</span> <span class="s2">&quot;payeeId&quot;</span><span class="p">],</span>
  <span class="nt">&quot;aggregateFieldName&quot;</span><span class="p">:</span> <span class="s2">&quot;paymentAmount&quot;</span><span class="p">,</span>
  <span class="nt">&quot;aggregatorFunctionType&quot;</span><span class="p">:</span> <span class="s2">&quot;SUM&quot;</span><span class="p">,</span>
  <span class="nt">&quot;limitOperatorType&quot;</span><span class="p">:</span> <span class="s2">&quot;GREATER&quot;</span><span class="p">,</span>
  <span class="nt">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
  <span class="nt">&quot;windowMinutes&quot;</span><span class="p">:</span> <span class="mi">10080</span>
<span class="p">}</span></code></pre></div>

<p>At this point it is important to understand that <strong><code>groupingKeyNames</code></strong> determine the actual physical grouping of events - all Transactions with the same values of specified parameters (e.g. <em>beneficiary #25 -&gt; payee #12</em> have to be aggregated in the same parallel instance of the evaluating operator. Naturally, the process of distributing data in such manner in Flink’s API is realised by a <code>keyBy()</code> function.</p>

<p>Although most examples in the <a href="https://ci.apache.org/projects/flink/flink-docs-stable/dev/api_concepts.html#define-keys-using-field-expressions">documentation</a> use specific fixed events’ fields, nothing prevents us from extracting them in a more dynamic fashion, based on the specifications of the rules. For this we will need one additional preparation step before invoking the <code>keyBy()</code> function.</p>

<p>Let’s look at a high level how our main processing pipeline might look like:</p>

<div class="highlight"><pre><code class="language-java"><span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Alert</span><span class="o">&gt;</span> <span class="n">alerts</span> <span class="o">=</span>
    <span class="n">transactions</span>
        <span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="k">new</span> <span class="nf">DynamicKeyFunction</span><span class="o">())</span>
        <span class="o">.</span><span class="na">keyBy</span><span class="o">(</span><span class="cm">/* some key selector */</span><span class="o">);</span>
        <span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="cm">/* actual calculations and alerting */</span><span class="o">)</span></code></pre></div>

<p>Given a set of predefined rules in the first step of the processing pipeline, we would like to iterate over them and prepare every event to be dispatched to a respective aggregating instance. This is what is done in <code>DynamicKeyFunction</code>:</p>

<div class="highlight"><pre><code class="language-java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DynamicKeyFunction</span>
    <span class="kd">extends</span> <span class="n">ProcessFunction</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">,</span> <span class="n">Keyed</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
   <span class="o">...</span>
  <span class="cm">/* Simplified */</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Rule</span><span class="o">&gt;</span> <span class="n">rules</span> <span class="o">=</span> <span class="cm">/* Rules that are initialized somehow.</span>
<span class="cm">                        Details will be discussed in a separate section. */</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">processElement</span><span class="o">(</span>
      <span class="n">Transaction</span> <span class="n">event</span><span class="o">,</span>
      <span class="n">Context</span> <span class="n">ctx</span><span class="o">,</span>
      <span class="n">Collector</span><span class="o">&lt;</span><span class="n">Keyed</span><span class="o">&lt;</span><span class="n">Transaction</span><span class="o">,</span> <span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">out</span><span class="o">)</span> <span class="o">{</span>

      <span class="k">for</span> <span class="o">(</span><span class="n">Rule</span> <span class="n">rule</span> <span class="o">:</span><span class="n">rules</span><span class="o">)</span> <span class="o">{</span>
       <span class="n">out</span><span class="o">.</span><span class="na">collect</span><span class="o">(</span>
           <span class="k">new</span> <span class="n">Keyed</span><span class="o">&lt;&gt;(</span>
               <span class="n">event</span><span class="o">,</span>
               <span class="n">KeysExtractor</span><span class="o">.</span><span class="na">getKey</span><span class="o">(</span><span class="n">rule</span><span class="o">.</span><span class="na">getGroupingKeyNames</span><span class="o">(),</span> <span class="n">event</span><span class="o">),</span>
               <span class="n">rule</span><span class="o">.</span><span class="na">getRuleId</span><span class="o">()));</span>
      <span class="o">}</span>
  <span class="o">}</span>
  <span class="o">...</span>
<span class="o">}</span></code></pre></div>
<p><code>KeysExtractor.getKey()</code> uses reflection to extract required values of <code>groupingKeyNames</code> fields from events and combines them as a single concatenated String key, e.g <code>{beneficiaryId=25;payeeId=12}</code>.</p>

<p>Notice that a wrapper class <code>Keyed</code> with the following signature was introduced as the output type of <code>DynamicKeyFunction</code>:</p>

<div class="highlight"><pre><code class="language-java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Keyed</span><span class="o">&lt;</span><span class="n">IN</span><span class="o">,</span> <span class="n">KEY</span><span class="o">,</span> <span class="n">ID</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="n">IN</span> <span class="n">wrapped</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">KEY</span> <span class="n">key</span><span class="o">;</span>
  <span class="kd">private</span> <span class="n">ID</span> <span class="n">id</span><span class="o">;</span>

  <span class="o">...</span>
  <span class="kd">public</span> <span class="n">KEY</span> <span class="nf">getKey</span><span class="o">(){</span>
      <span class="k">return</span> <span class="n">key</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>Where <code>wrapped</code> is the original Transaction event data, <code>key</code> is the result of using <code>KeysExtractor</code> and <code>id</code> is the ID of the Rule which caused the dispatch of the event according to this Rule’s grouping logic.</p>

<p>Events of this type will be the input to the <code>keyBy()</code> function of the main processing pipeline. This allows us to use a simple lambda-expression in place of a <a href="https://ci.apache.org/projects/flink/flink-docs-stable/dev/api_concepts.html#define-keys-using-key-selector-functions"><code>KeySelector</code></a> as the final step of implementing dynamic data shuffle.</p>

<div class="highlight"><pre><code class="language-java"><span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Alert</span><span class="o">&gt;</span> <span class="n">alerts</span> <span class="o">=</span>
    <span class="n">transactions</span>
        <span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="k">new</span> <span class="nf">DynamicKeyFunction</span><span class="o">())</span>
        <span class="o">.</span><span class="na">keyBy</span><span class="o">((</span><span class="n">keyed</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">keyed</span><span class="o">.</span><span class="na">getKey</span><span class="o">());</span>
        <span class="o">.</span><span class="na">process</span><span class="o">(</span><span class="cm">/* actual calculations and alerting */</span><span class="o">)</span></code></pre></div>

<p>Effectively we are forking events for parallel evaluation in the Flink cluster. There is a certain amount of data duplication which is required for making use of Flink’s parallel model of execution. In a real-life scenario, an additional layer for filtering and propagating only those Transaction fields which are actually needed for evaluation of specific rules could be applied to decrease this impact.</p>

<center>
<img src="/img/blog/2019-11-19-demo-fraud-detection/shuffle.png" width="800px" alt="Figure 3: Events Shuffle" />
<br />
<i><small>Figure 3: Events Shuffle</small></i>
</center>
<p><br /></p>

<p>Building a fully fledged DSL and a rules engine is not the focus of this post, hence this part is be kept to a minimum of what is required to show case intended functionality. You can, however, think about implementing more sophisticated rules, including filtering of certain events, rules chaining and other more advanced scenarios.</p>

<p>In the next part of this series of blog posts, we will look into how these rule sets make it into Flink and how they can be added and removed at runtime (the Dynamic Application Updates pattern).</p>

      </article>
    </div>

    <div class="row">
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'stratosphere-eu'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
  </div>
</div>
      </div>
    </div>

    <hr />

    <div class="row">
      <div class="footer text-center col-sm-12">
        <p>Copyright © 2014-2019 <a href="http://apache.org">The Apache Software Foundation</a>. All Rights Reserved.</p>
        <p>Apache Flink, Flink®, Apache®, the squirrel logo, and the Apache feather logo are either registered trademarks or trademarks of The Apache Software Foundation.</p>
        <p><a href="/privacy-policy.html">Privacy Policy</a> &middot; <a href="/blog/feed.xml">RSS feed</a></p>
      </div>
    </div>
    </div><!-- /.container -->

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.matchHeight/0.7.0/jquery.matchHeight-min.js"></script>
    <script src="/js/codetabs.js"></script>
    <script src="/js/stickysidebar.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
